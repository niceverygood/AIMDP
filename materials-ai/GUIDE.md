# Materials AI Platform — 상세 기술 설명서

## 동진쎄미켐 AI 기반 신소재 탐색 플랫폼

---

## 1. 시스템 개요

### 이 시스템은 무엇인가?

연구원이 **"열안정성 400°C 이상, 밴드갭 3.0 eV 이상인 OLED 호스트 소재를 찾아줘"** 라고 조건을 입력하면, AI가 데이터베이스에서 최적 후보를 찾아주고, 나아가 **아직 세상에 없는 새로운 분자 구조까지 설계**해주는 시스템입니다.

### 핵심 기능 3가지

```
┌─────────────────┐     ┌──────────────────┐     ┌──────────────────────┐
│  ① AI 소재 탐색  │ ──→ │  ② AI 신소재 발굴  │ ──→ │  ③ 시뮬레이션 예측   │
│  (기존 DB 검색)   │     │  (새 분자 설계)     │     │  (성능 예측)         │
└─────────────────┘     └──────────────────┘     └──────────────────────┘
```

1. **AI 소재 탐색**: 기존 데이터베이스에서 조건에 맞는 소재를 벡터 유사도 + 물성 필터로 찾아 랭킹
2. **AI 신소재 발굴**: 기존 데이터의 구조-물성 관계를 학습하여 아직 존재하지 않는 새 분자 구조 제안
3. **시뮬레이션 예측**: 제안된 소재의 열역학, 전자구조, 합성경로, 환경영향을 AI가 예측

---

## 2. AI 예측 모델 상세 설명

### 2-1. 트리플 AI 앙상블 (Triple AI Ensemble)

3개의 세계 최정상 AI 모델이 **독립적으로** 같은 문제를 분석한 후, **교차 검증**을 통해 합의된 결과만 추천합니다.

| 모델 | 역할 | 강점 |
|------|------|------|
| 🟠 **Claude Opus 4** (Anthropic) | 분자 구조 분석 + 합성 가능성 추론 | 긴 문맥 이해, 논리적 추론 |
| 🔵 **Gemini 2.5 Pro** (Google) | 학술 논문 기반 물성 교차검증 | 광범위한 학술 데이터 |
| 🟢 **GPT-4o** (OpenAI) | 특허 데이터 분석 + 응용 분야 매칭 | 실용적 분석, 특허 해석 |

#### 앙상블 알고리즘 작동 방식

```
Step 1: 병렬 호출
  ┌── Claude에게 "이 소재들 분석해줘" ─── 독립 분석 결과 A
  │
  ├── Gemini에게 "이 소재들 분석해줘" ─── 독립 분석 결과 B
  │
  └── GPT에게 "이 소재들 분석해줘"   ─── 독립 분석 결과 C

Step 2: 합의 점수 계산
  각 소재별로:
  - 몇 개 모델이 추천했는가? (votes)
  - 각 모델의 신뢰도(confidence)는? (0~1)
  - 합의 보너스: 3개 모두 동의하면 × 1.3배

  앙상블 점수 = 평균_신뢰도 × 합의_보너스 × (투표수 / 전체모델수)

Step 3: 최종 랭킹
  앙상블 점수 순으로 정렬 → 상위 5개 추천
```

**예시 결과:**
- Ir(ppy)3: Claude ✓ + Gemini ✗ + GPT ✓ = 2/3 투표, 합의율 66.7%
- TPBi: Claude ✓ + Gemini ✓ + GPT ✓ = 3/3 투표, 합의율 100% → 합의 보너스 1.3배

### 2-2. 물성 예측 모델 (Property Prediction)

분자 구조(SMILES)를 입력하면 5가지 핵심 물성을 예측합니다.

#### 현재 (PoC): RDKit 휴리스틱 기반

RDKit 라이브러리로 분자 기술자(descriptor)를 계산한 후, 경험적 상관관계 공식으로 물성을 추정합니다.

```
입력: SMILES 문자열 (예: "c1ccccc1" = 벤젠)
        ↓
RDKit 파싱 → 분자 객체(Mol) 생성
        ↓
분자 기술자 계산:
  - 분자량 (MW)
  - 소수성 (LogP)
  - 극성 표면적 (TPSA)
  - 수소결합 공여/수용체 (HBD, HBA)
  - 방향족 고리 수 (n_aromatic)
  - 회전 가능 결합 수
        ↓
물성 추정 공식:
  열안정성  = 120 + 방향족고리 × 45 + 분자량 × 0.15 - |LogP| × 3   (범위: 80~500°C)
  유전율    = 2.5 + TPSA × 0.04 + HBA × 0.3 - LogP × 0.15          (범위: 1.5~25)
  밴드갭    = 4.5 - 방향족고리 × 0.4 - LogP × 0.08 + TPSA × 0.005  (범위: 0.5~8 eV)
  용해도    = 0.5 - LogP × 0.08 + TPSA × 0.004                      (범위: 0~1)
  밀도      = 0.85 + 분자량 × 0.0015 + 방향족고리 × 0.03            (범위: 0.6~2.5 g/cm³)
```

**한계**: 추정 정확도 약 65~75%. 분자의 세부 구조 차이를 반영하기 어려움.

#### 미래 (프로덕션): Uni-Mol 신경망 기반

```
입력: SMILES 문자열
        ↓
Uni-Mol 사전학습 모델 → 768차원 벡터 (3D 구조 정보 포함)
        ↓
신경망 헤드 (Fine-tuned):
  768 → [LayerNorm → ReLU → Dropout 0.2] → 256
  256 → [LayerNorm → ReLU → Dropout 0.1] → 128
  128 → [ReLU] → 64
   64 → 5 (열안정성, 유전율, 밴드갭, 용해도, 밀도)
        ↓
학습: MSE Loss + AdamW + Cosine Annealing LR
```

**기대 정확도**: R² > 0.90 (QM9 + 동진 데이터로 학습 시)

### 2-3. 벡터 유사도 검색 (Vector Similarity Search)

"이 분자와 구조적으로 비슷한 소재를 찾아줘"를 수행합니다.

```
입력 분자 (SMILES)
      ↓
Morgan Fingerprint 생성 (반경 2, 2048-bit)
      ↓
고정 프로젝션 행렬 (2048 × 768, 시드=42) 로 차원 축소
      ↓
L2 정규화 → 768차원 벡터
      ↓
DB의 모든 소재 벡터와 코사인 유사도 계산
      ↓
유사도 순 정렬
```

**코사인 유사도 해석:**
- **1.0**: 완전히 동일한 분자
- **0.7~1.0**: 매우 유사한 구조 (같은 관능기, 유사한 고리)
- **0.3~0.7**: 부분적 유사 (일부 구조 공유)
- **0.0~0.3**: 거의 다른 구조

**실제 검증 예시:**
- 벤젠(c1ccccc1) 검색 → 벤젠 자체: 유사도 1.0
- DPEPO(페닐기 3개 포함) → 유사도 0.45 (구조적으로 타당)
- EC(에틸렌 카보네이트, 고리형이지만 방향족 아님) → 유사도 0.01 (올바른 판단)

### 2-4. 다목적 최적화 랭킹 (Multi-Objective Ranking)

여러 물성을 동시에 고려하여 최적 소재를 찾는 알고리즘입니다.

```
최종 점수 = Σ (가중치_i × 정규화_점수_i) / Σ 가중치_i

정규화: 각 물성을 0~1 범위로 변환
  예) 열안정성 380°C → (380 - 0) / (500 - 0) = 0.76

기본 가중치:
  벡터 유사도: 40%
  열안정성:   20%
  유전율:     20%
  밴드갭:     20%

→ 사용자가 슬라이더로 가중치 조절 가능
```

---

## 3. 연구 데이터 업로드 및 처리 과정

### 3-1. 파일 업로드 과정

```
연구원이 CSV/Excel 파일 업로드
          ↓
┌─────────────────────────┐
│ Step 1: 파일 파싱        │  pandas로 CSV/Excel 읽기
├─────────────────────────┤
│ Step 2: 컬럼 자동 매핑   │  "SMILES" → smiles, "열안정성" → thermal_stability
├─────────────────────────┤
│ Step 3: SMILES 검증      │  RDKit로 유효성 확인, 유효하지 않은 행 건너뜀
├─────────────────────────┤
│ Step 4: 분자 기술자 계산  │  분자량, LogP, TPSA 등 14개 기술자 자동 계산
├─────────────────────────┤
│ Step 5: 벡터 임베딩 생성  │  Morgan FP → 768차원 벡터
├─────────────────────────┤
│ Step 6: DB 저장          │  소재 정보 + 기술자 + 임베딩을 한 행으로 저장
└─────────────────────────┘
          ↓
업로드 결과: "150건 중 142건 등록, 8건 스킵 (유효하지 않은 SMILES)"
```

### 3-2. 지원하는 파일 형식 및 컬럼명

| 형식 | 확장자 | 비고 |
|------|--------|------|
| CSV | .csv | 쉼표 또는 탭 구분 자동 감지 |
| Excel | .xlsx, .xls | 첫 번째 시트 사용 |
| TSV | .tsv | 탭 구분 |

**자동 인식되는 컬럼명:**

| 컬럼 | 인식되는 이름 (대소문자 무관) |
|------|--------------------------|
| 분자 구조 | smiles, SMILES, smi |
| 이름 | name, 이름, 소재명, material |
| 카테고리 | category, 카테고리, 분류 |
| 열안정성 | thermal_stability, Td, 열안정성, thermal |
| 유전율 | dielectric_constant, Dk, 유전율, dielectric |
| 밴드갭 | bandgap, Eg, 밴드갭, band_gap |
| 용해도 | solubility, 용해도 |
| 밀도 | density, 밀도 |

### 3-3. 예시 CSV 파일

```csv
SMILES,이름,카테고리,열안정성,밴드갭,유전율
c1ccc(-c2ccnc3c2ccc2c(-c4ccccc4)ccnc23)cc1,BPhen,OLED,380,3.5,3.2
c1ccc(-n2c3ccccc3c3ccccc32)cc1,TCTA,OLED,395,3.4,3.1
O=C1OCCO1,EC,battery,248,6.7,89.8
```

---

## 4. AI 신소재 발굴 과정 상세

### 4-1. 작동 원리

```
Step 1: 기존 데이터 수집
  DB에서 해당 카테고리의 소재 최대 30건을 가져옴
  (검증된 소재 우선, 열안정성 높은 순)

Step 2: 구조-물성 관계(SPR) 분석 요청
  3개 AI 모델에게 기존 데이터를 보내며 질문:
  "이 데이터에서 구조-물성 패턴을 파악하고,
   기존에 없는 새로운 분자를 3~5개 설계해줘"

Step 3: 각 모델의 독립 분석
  🟠 Claude: "방향족 고리가 많을수록 열안정성이 높다.
              그런데 용해도가 떨어진다. 중간 수준의 새 구조를 설계..."
  🔵 Gemini: "논문 데이터에 의하면 이 카테고리에서
              인-질소 결합이 유전율을 높인다..."
  🟢 GPT:    "특허 분석 결과 이 구조의 변형이
              합성 가능성이 높고 비용이 낮다..."

Step 4: 결과 병합 및 중복 제거
  - SMILES 기준으로 중복 제거
  - 여러 모델이 같은 소재를 제안하면 투표 점수 상승
  - 신규성 점수(novelty_score) 순으로 정렬
```

### 4-2. AI 제안 결과에 포함되는 정보

각 제안 소재에 대해 다음 정보가 제공됩니다:

| 항목 | 설명 | 예시 |
|------|------|------|
| 이름 | AI가 명명한 소재명 | "Novel OLED Host-1" |
| SMILES | 분자 구조 표기 | "c1ccc2c(c1)..." |
| 설계 근거 | 이 구조를 왜 설계했는지 | "기존 TPBi의 벤즈이미다졸..." |
| 예측 물성 | 5가지 물성 예측값 | 열안정성: 410°C |
| 신규성 | 기존 데이터와 얼마나 다른지 | 85% |
| 합성 난이도 | easy / moderate / difficult / very_difficult | moderate |
| 비용 레벨 | low / medium / high / very_high | medium |
| 핵심 출발물질 | 합성에 필요한 주요 원료 | ["카바졸", "트리메틸보론산"] |
| 적용 분야 | 어디에 쓸 수 있는지 | ["OLED 호스트", "청색 발광"] |

---

## 5. 시뮬레이션 예측 상세

### 5-1. 시뮬레이션 항목

제안된 소재의 "시뮬레이션 실행" 버튼을 누르면, 3개 AI가 다음 4가지 영역을 예측합니다.

#### (1) 분자동역학 (Molecular Dynamics)
| 예측 항목 | 설명 | 단위 |
|----------|------|------|
| 유리전이온도 (Tg) | 고체→유리 상태 전이 온도 | °C |
| 분해온도 (Td) | 분자가 분해되기 시작하는 온도 | °C |
| 열팽창계수 | 온도에 따른 체적 변화율 | ppm/°C |
| 안정성 등급 | excellent / good / moderate / poor | - |

#### (2) 전자구조 계산 (Electronic Properties)
| 예측 항목 | 설명 | 단위 |
|----------|------|------|
| HOMO 에너지 | 최고 점유 분자 궤도 에너지 | eV |
| LUMO 에너지 | 최저 비점유 분자 궤도 에너지 | eV |
| 밴드갭 | HOMO-LUMO 에너지 차이 | eV |
| 전자 이동도 | 전자의 이동 속도 | cm²/V·s |
| 정공 이동도 | 정공의 이동 속도 | cm²/V·s |

#### (3) 합성 경로 시뮬레이션 (Synthesis Route)
| 예측 항목 | 설명 |
|----------|------|
| 추천 합성 경로 | 어떤 반응으로 만들 수 있는지 |
| 핵심 반응 | Suzuki 커플링, Buchwald-Hartwig 등 |
| 예상 수율 | 최종 생성물 수율 (%) |
| 합성 단계 수 | 몇 단계가 필요한지 |
| 난이도 | easy ~ very_difficult |
| 그램당 예상 비용 | USD |
| 스케일업 가능성 | 대량 생산 가능 여부 |

#### (4) 환경 평가 (Environmental Assessment)
| 예측 항목 | 설명 |
|----------|------|
| 독성 위험 | low / medium / high |
| 생분해성 | good / moderate / poor |
| 규제 우려 | 관련 규제 사항 |

### 5-2. 시뮬레이션 결과 합산 방식

```
3개 모델의 시뮬레이션 결과를 합산:

숫자값 (분해온도, 밴드갭, 수율 등):
  → 3개 모델 예측의 평균값 사용
  예) Claude: Td=380°C, Gemini: Td=395°C, GPT: Td=370°C
  → 평균: 381.7°C

범주값 (안정성 등급, 난이도 등):
  → 다수결(Mode) 사용
  예) Claude: "good", Gemini: "excellent", GPT: "good"
  → 최종: "good" (2:1)
```

---

## 6. 데이터베이스 구조

### 소재 테이블 (materials)

| 컬럼 | 타입 | 설명 |
|------|------|------|
| id | 정수 | 고유 ID (자동 증가) |
| name | 텍스트 | 소재명 |
| smiles | 텍스트 | 분자 구조 (SMILES 표기) |
| category | 텍스트 | OLED, battery, semiconductor 등 |
| molecular_weight | 실수 | 분자량 (g/mol) |
| logp | 실수 | 소수성 지표 |
| hbd | 정수 | 수소결합 공여체 수 |
| hba | 정수 | 수소결합 수용체 수 |
| tpsa | 실수 | 극성 표면적 (Å²) |
| rotatable_bonds | 정수 | 회전 가능 결합 수 |
| aromatic_rings | 정수 | 방향족 고리 수 |
| thermal_stability | 실수 | 열안정성 (°C) |
| dielectric_constant | 실수 | 유전율 |
| bandgap | 실수 | 밴드갭 (eV) |
| solubility | 실수 | 용해도 (0~1) |
| density | 실수 | 밀도 (g/cm³) |
| embedding | 텍스트 | 768차원 벡터 (JSON) |
| source | 텍스트 | 데이터 출처 |
| is_verified | 정수 | 실험 검증 여부 (0/1) |

### 실험 결과 테이블 (experiments)

연구원이 실제 실험한 결과를 기록하여 AI 모델의 예측 정확도를 개선합니다.

| 컬럼 | 설명 |
|------|------|
| material_id | 어떤 소재에 대한 실험인지 |
| actual_thermal_stability | 실측 열안정성 |
| actual_dielectric_constant | 실측 유전율 |
| actual_bandgap | 실측 밴드갭 |
| success | 실험 성공 여부 |
| notes | 연구원 메모 |
| researcher | 연구원 이름 |

---

## 7. 현재 데이터 현황

### 초기 탑재 데이터 (104건)

| 카테고리 | 건수 | 검증 | 대표 소재 |
|----------|------|------|----------|
| OLED | 14 | ✓ | BPhen, TPBi, Alq3, Ir(ppy)3, CBP, mCP |
| 배터리 | 18 | ✓ | EC, DMC, EMC, FEC, VC, LiPF6, LiBOB |
| 반도체 | 5 | ✓ | Polyimide, SU-8, BCB, Parylene-C, PTFE |
| 하드코팅 | 3 | ✓ | TEOS, GPTMS, TMSPM |
| 디스플레이 | 3 | ✓ | 5CB, 7CB, MBBA |
| 유기분자 | 61 | 일부 | 벤젠, 나프탈렌, 카페인, 아스피린 등 (ESOL) |

---

## 8. 페이지별 기능 안내

### 📊 대시보드 (`/`)
- 전체 소재 수, 검증된 소재, 예측 모델 상태, 카테고리 수
- 월별 데이터 추이 차트
- 카테고리 분포 파이 차트
- 물성별 예측 정확도 바 차트
- 시스템 모듈 연결 상태
- **Triple AI 홍보 배너**: 3개 AI 앙상블 소개

### 🔍 AI 소재 탐색 (`/search`)
- SMILES 입력 → 구조적으로 유사한 소재 검색
- 카테고리 필터 (OLED, 배터리 등)
- 물성 조건 슬라이더 (열안정성, 유전율, 밴드갭, 용해도)
- 결과 카드: 적합도(%), 레이더 차트, 물성값, 유사도 배지
- **AI 앙상블 분석 버튼**: 3개 AI가 결과를 교차 검증

### ✨ AI 신소재 발굴 (`/discover`)
- 목표 카테고리 + 추가 조건 설정
- 3개 AI가 기존 데이터를 학습 → 새 분자 구조 3~5개 제안
- 각 제안: 예측 물성, 합성 난이도, 비용, 신규성 점수
- **시뮬레이션 실행**: 소재별 열역학/전자구조/합성경로/환경 예측

### 📂 연구 데이터 (`/data`)
- CSV/Excel 파일 업로드 → 자동 파싱 → DB 저장
- 데이터 현황: 출처별/카테고리별 분포
- 물성 커버리지: 각 물성별 데이터 보유 비율

### ⚙️ 파이프라인 (`/pipeline`)
- 6단계 자동 처리: 수집 → 정규화 → 정제 → 특성추출 → 임베딩 → 데이터셋
- 실시간 진행률 (WebSocket)
- 단계별 처리 건수, 품질 점수, 소요 시간

---

## 9. 기술 스택

| 영역 | 기술 | 용도 |
|------|------|------|
| Frontend | Next.js 14 + TypeScript + Tailwind | 웹 UI |
| UI 라이브러리 | shadcn/ui + Framer Motion + Recharts | 컴포넌트, 애니메이션, 차트 |
| Backend | FastAPI (Python) | REST API 서버 |
| AI 모델 | OpenRouter (Claude + Gemini + GPT) | 앙상블 분석, 신소재 제안, 시뮬레이션 |
| 화학 라이브러리 | RDKit | 분자 파싱, 기술자 계산, 3D 구조 |
| 벡터 검색 | Morgan FP → 768-dim 코사인 유사도 | 구조 유사성 검색 |
| 데이터베이스 | SQLite (PoC) / PostgreSQL + pgvector (프로덕션) | 소재 데이터 + 벡터 저장 |
| 인프라 | Docker Compose | 개발/배포 환경 |

---

## 10. 향후 로드맵

| 단계 | 내용 | 예상 효과 |
|------|------|----------|
| **Phase 1** (현재) | RDKit 기반 PoC + 3 AI 앙상블 | 기본 구조 유사도 검색 + AI 분석 |
| **Phase 2** | Uni-Mol 임베딩 도입 (GPU 서버) | 유사도 정확도 30% → 90% |
| **Phase 3** | 동진쎄미켐 사내 데이터 대량 적재 | AI 학습 데이터 100배 확장 |
| **Phase 4** | PropertyPredictor 신경망 학습 | 물성 예측 R² > 0.90 |
| **Phase 5** | ConditionalMolVAE 역설계 모델 | 조건 입력 → 새 분자 자동 생성 |
| **Phase 6** | Active Learning 피드백 루프 | 실험 결과 → 모델 자동 개선 |

---

*이 문서는 Materials AI Platform v0.2.0 (2026.02) 기준으로 작성되었습니다.*
